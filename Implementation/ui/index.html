<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SOC Assistant — Query & Charts</title>
  <link rel="stylesheet" href="css/styles.css">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
  <script src="script/app.js" defer></script>
  <div class="wrap">
    <h1>LLM-Powered SOC Assistant</h1>
    <div class="sub">Ask in natural language. We’ll generate SQL, show rows, and render charts when your prompt asks for
      them.</div>

    <div class="card section">
      <div class="row">
        <textarea id="q"
          placeholder="e.g. Show failed vs successful sshd attempts for agent Kali4495 in the last 24 hours with a percentage chart"></textarea>
        <div class="toolbar">
          <button class="btn" id="askBtn">Ask</button>
          <div class="btn-row">
            <button class="btn-ghost" id="insightsBtn">Quick Insight: Top src_ip (24h)</button>
            <button class="btn-ghost" id="btnChartByHour">Failed sshd by hour (24h)</button>
            <button class="btn-ghost" id="btnChartTopIPs">Top src_ip for failed sshd (24h)</button>
          </div>
          <div class="btn-row">
            <button class="btn-ghost" id="fetchBtn">Fetch latest logs</button>
            <small id="fetchMsg" class="muted"></small>
            <button class="btn-ghost" id="resetBtn">Reset</button>
          </div>
        </div>
      </div>

      <div class="chips">
        <span class="chip">Show failed sshd logins in the last 24 hours</span>
        <span class="chip">Top source IPs for failed sshd logins (last 72 hours)</span>
        <span class="chip">Show sudo events for agent Kali4495 (48 hours)</span>
        <span class="chip">Compare failed vs successful SSH for agent Kali4495 with a chart</span>
      </div>

      <div id="err" class="err" style="display:none"></div>
      <div id="meta" class="meta" style="display:none"></div>
    </div>

    <div class="grid" style="margin-top:16px">
      <div class="card section">
        <h3>Generated SQL</h3>
        <pre id="sql" class="muted">—</pre>
        <h3 style="margin-top:10px;">Rows</h3>
        <div id="rows">—</div>
      </div>

      <!-- charts card spans full width on desktop -->
      <div class="card section charts-span-2">
        <h3>Charts</h3>
        <div class="chart-wrap">
          <div class="chart-toolbar">
            <button class="btn-ghost" id="btnUseServerChart">Use server-provided chart (if available)</button>
            <button class="btn-ghost" id="btnPieFailedVsSuccess">Pie: failed vs successful (server chart)</button>
          </div>
          <canvas id="chart"></canvas>
        </div>
      </div>
    </div>
  </div>
</body>

</html>